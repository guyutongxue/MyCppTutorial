# 最麻烦的门槛

这节标题叫做“最麻烦”的“门槛”，是因为 C++ 的一个神奇特性导致的——就是想要让一个 C++ 代码编译并运行是一件很复杂的事情，对于“电脑小白”来说更为困难。这件麻烦的事情一般称为“配置环境”，其中环境指的就是集成开发环境（Integrated Development Environment, IDE）。

一般的教材都不会花特别多的笔墨介绍怎么配置环境，我认为那算是一种不太负责任的行为。因此我在这里多多少少写几笔吧，希望能够帮到各位读者。

首先为了验证你的环境是否配置成功，我直接告诉你以下这段代码：

```cpp codemo(show)
#include <iostream>
int main() {
    std::cout << "Hello, world!" << std::endl;
}
```

**编译并运行**后的结果是，*输出*一句话叫 `Hello, world!`。那肯定有人问，什么叫输出一句话？目前这里指的就是在电脑屏幕的某个地方会出现这样一句话。它出现的形式可以是：

- 弹出一个黑底白字的窗口，显示这句话（可能还会带一些别的乱七八糟东西）；
- 弹出一个白底黑字的窗口，显示这句话（可能还会带一些别的乱七八糟东西）；
- 屏幕角落或边缘的一个窗口显示了这句话；
- “终端窗口”中显示了这句话；
- ……

::: warning
上文代码框左侧的 “1,2,3,4” 是行号，仅为了行文方便而展示，不是代码的一部分。代码从 `#include` 开始直到结尾 `}`。
:::

总之有各种各样的形式，具体的表现依操作系统和配置方法的不同而不同。因此，一旦你看到了这句话被输出了，那么就证明你的 C++ 代码被成功编译并运行了，也就意味着环境配置完成，你成功迈过了这道门槛。

下面我将分操作系统来简要介绍配置方法。

[[TOC]]

## Windows

如果你用的是 Windows，很幸运你拥有许多选择。我以下将列出一些可用的方案，从前到后推荐度下降，请一一尝试。

### 使用 Visual Studio Code

Visual Studio Code 是一款非常现代的文本编辑器，可以支持编译并运行 C++ 代码。现在你需要做的事情非常简单，前往[这里](https://vscch.guyutongxue.site)下载一个配置工具，然后双击运行它即可。你只需要按照工具的提示一步一步做下去就可以了。

当你完成配置的时候，工具会提示生成测试代码，这个代码与我之前给出的代码是相同的。因此你可以直接按照提示编译并运行（或调试），即可观察到下方（或弹窗）输出了 `Hello, world!` 。

### 使用 Visual Studio

若没能玩明白 Visual Studio Code，那么 Visual Studio 也是一个不错的选择。但前提是你需要有更充足的时间和空间（因为它安装所需要的空间和时间开销都比较大）。

首先请前往 [Visual Studio 官方网站](https://visualstudio.microsoft.com/zh-hans/vs/) 获取 Visual Studio。其中，Visual Studio 2022 Community 是面向个人的免费版本。下载并启动安装程序后，你需要勾选“使用C++的桌面工具开发”这一工作负载，然后点击右下角安装。安装时间可能较长，需要耐心等待。

安装完成后，你可以从开始菜单启动 Visual Studio。

1. 启动后，选择“创建新项目”；
1. 筛选语言为“C++”，平台为“Windows”，选择“空项目（使用 C++ for Windows 从头开始操作。不提供基础文件。）选项，随后点击下一步；
1. 确认这个项目存放的目录位置和项目名称。这里项目名称可以写作“HelloWorld”或者任何你喜欢的名字。点击创建以继续；
1. 注意到目前打开界面中有一个“解决方案资源管理器”的子窗口。其中有一个名为“源文件”的文件夹。鼠标右键，添加 -> 新建项，修改名称为 main.cpp，添加。现在你拥有了一个 C++ 文件；
1. Visual Studio 可能已经为你打开了这个文件。如果没有，请在解决方案资源管理器中双击打开它。现在你可以书写上文中提供的代码了。如果你害怕敲错，你可以直接复制粘贴。

现在你可以点击上方带有绿色三角的“本地 Windows 调试器”按钮。如果一切无误，您将看到一个黑底白字的弹窗，第一行写着 `Hello, world!` 。恭喜！

### 使用 Dev-C++

如果你喜欢小巧、可靠的环境，或者说你电脑内的所剩空间有限，那么 Dev-C++ 应该比较适合你。

请注意，网上大多数 Dev-C++ 的安装包都是较为过时的。在这里，我提供一个 [非官方但较新的版本](https://royqh.net/redpandacpp/download) 并推荐读者使用。（[官方版本](https://github.com/Embarcadero/Dev-Cpp/releases)也可以，但稳定性不高。）使用方法很简单，下载该安装包后运行安装即可。

安装完成后，你可以在 Dev-C++ 内新建一个文件（文件 -> 新建 -> 源文件）。然后你可以将开头提供的代码抄上或者复制粘贴上去。然后点击上方的编译并运行按钮（或者按 `F11` ），选择文件保存的位置。随后你就可以看到黑底白字的弹窗，其中第一行为 `Hello, world!` 。

### 使用 Code::Blocks

Code::Blocks 是类似 Dev-C++ 的开发环境。不同的是，Code::Blocks 一直在更新，功能也相对较多。

首先请前往 [Code::Blocks 下载页面](http://www.codeblocks.org/downloads/26) 。您需要根据您的系统版本（64位或32位）选择正确的下载链接。请您务必选择带有 mingw 的链接，如 `codeblocks-20.03mingw-setup.exe` 。右侧提供了两个下载源，其中 SourceForge 的下载速度相对较快。

下载后安装即可。安装之后启动 Code::Blocks，然后新建一个空文件（File -> New -> Empty File)。现在你可以在这里书写代码，将上文提供的代码抄或复制粘贴到这里。随后点击上方的绿色箭头即可编译并运行。首次编译会提示保存，请**务必**将后缀名改为 `.cpp` ；即文件名以 `.cpp` 结尾如  `Untitled1.cpp` 。若一切无误，则弹出黑底白字窗口，其中第一行输出 `Hello, world!` 。

## macOS

如果你使用的是 Mac，你也可以有一些选择。不过对于任何选择来说，你必须要做的第一件事情是安装编译器。安装编译器的方法很简单，只需找到终端程序（Terminal.app）并键入以下命令
```bash
xcode-select --install
```
然后在弹出窗口中选择“安装”。你可能需要等待片刻，安装将自动完成。随后你可以按照以下方案的任何一种配置：

### 使用 Visual Studio Code

macOS 下也可以使用 Visual Studio Code。前往[这里](https://vscch.guyutongxue.site)下载一个配置工具，然后运行其中的程序即可。你只需要按照工具的提示一步一步做下去就可以了。

### 使用 CLion

CLion 应当是 Mac 下好评如潮的集成开发环境，但是它是付费软件。我不推荐你安装破解版，请支持正版。不过如果你是高校学生的话，可以获取免费的教育版。下载地址在[这里](https://www.jetbrains.com/clion/download/)。

CLion 会自动检测编译器等必要工具的配置。因此你不需要花费太多的力气，只需在 CLion 的欢迎界面中点击 “New Project”，然后选择项目类型为 C++ Executable （C++ 可执行文件）。选择你的项目存放路径，同时选择语言标准（不得低于 C++11)。

新建完成后，CLion 会为你打开两个文件 `CMakeList.txt` 和 `main.cpp` 。其中 `main.cpp` 是你要编写 C++ 程序的位置，另外一个可以不用管它。将本文开头的代码抄或者复制粘贴进来，点击右上角绿色三角图标，就可以成功地编译并运行。如果没有问题的话，下方会弹出一个子窗口并显示输出 `Hello, world!` 。

### 使用 Xcode

Xcode 是 Apple 官方提供的集成开发环境，但是由于使用它编写 C++ 时用户体验不佳，因此不被推荐。如果上述方案都无法配置成功，你可以尝试使用 Xcode。

[从 App Store 中安装 Xcode。](https://apps.apple.com/cn/app/xcode/id497799835)安装完成后启动，在欢迎界面中选择“Create a new Xcode project”。依次点击“macOS”“Command Line Tool”，点击下一步。接着确定项目名称、项目作者等其他无关紧要的设置，并选择语言为 C++。之后你就建立了一个新的 C++ 项目。

现在再左侧的子窗口中可以找到一个 main.cpp 的文件（可能位于路径 `<项目名称>/<项目名称>` 下），然后你就可以开始书写代码了。你可以将开头提供的测试代码抄下或者复制粘贴。随后点击左上角的黑色三角（播放）键，就会自动编译并运行；同时右下方的 Output （输出）子窗口会显示 `Hello, world!` 。

> 关于更多 macOS 下开发环境的配置，你可以阅读 [leavelet](https://leavelet.io) 编写的[《Mac 指北》](https://macguide.leavelet.io/Advanced/developmentEnvFromScratch.html)。

## GNU/Linux

尽管我认为不会有读者使用 GNU/Linux 系统，但是为了保证面面俱到，我仍然将 GNU/Linux 的配置方法简要写出。

### 使用 Visual Studio Code

前往[这里](https://vscch.guyutongxue.site)下载一个配置工具，按照工具的说明完成配置。

### 使用命令行

首先安装 C++ 编译器（如 `g++` 或 `clang++` ，以 `g++` 为例），这一步请参考你的发行版软件包管理器相关说明。然后新建（ `touch` ）一个以 `.cpp` 为后缀名的文件。用任意文本编辑器编辑代码，然后执行命令
```bash
g++ <file name> -std=c++17 -o helloworld.out
```
来编译。其中 `g++` 依你所采用的编译器而相应作出更改； `<file name>` 是你要编译的源文件。执行
```bash
./helloworld.out
```
来运行。如果没有问题，将直接输出 `Hello, world!` 并退出。
